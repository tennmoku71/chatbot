<html><meta charset="utf-8"><body>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<style>
    h1   { background-color: rgb(255, 224, 224); }
    div  { padding:10px; }
    span { border-radius: 10px; background-color: rgb(255, 224, 224); padding:8px; }
    .bot { text-align: left; }
    .usr { text-align: right; }
</style>
<h1>チャットボットと会話しよう</h1>
<div id="chat"></div>
<div class='usr'><input id="txt" size="40">
<button id="say" onclick="say()">発言</button></div>
<script>
var url = "./chatbot.py";
function say() {
  var txt = $('#txt').val();
  $.get(url, {"m":"say","txt":txt},
    function(res) {
      var html = "<div class='usr'><span>" + esc(txt) +
        "</span>:あなた</div><div class='bot'>ボット:<span>" + 
        esc(res) + "</span></div>";
      $('#chat').html($('#chat').html()+html);
      $('#txt').val('').focus();
    });
}
function esc(s) {
    return s.replace('&', '&amp;').replace('<','&lt;')
            .replace('>', '&gt;');
}

<!-- エンターキーを押すことで、「発言」ボタンを押したのと同じことにする -->
$('#txt').keydown(function (e) {
    if (e.keyCode == 13) {
        $('#say').click();
    }
});

</script></body></html>
